######MATURITY
MATU = read.table('../../Body/1Raw/FishBaseLmTm.txt')
colnames(MATU)=c("Species", "Lm", "Tm")
MATU$Species=gsub(" ", "_", MATU$Species)
MATUTm=MATU[!is.na(MATU$Tm),]
MATULm=MATU[MATU$Lm != "",]
View(MATUTm)
MATUTm$Lm = NULL
View(MATUTm)
View(MATULm)
MATULm$Tm = NULL
for (i in 1:nrow(MATULmmut)){
MATULmmut$Lm_value[i]=as.numeric(unlist(strsplit(as.character(MATULmmut$Lm[i]), ' '))[1])
MATULmmut$Lm_measure[i]=unlist(strsplit(as.character(MATULmmut$Lm[i]), ' '))[2]
}
MATULmmut$Tm = NULL
rm(list=ls(all=TRUE))
###TEMPERATURE another table
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
rm(list=ls(all=TRUE))
######MATURITY
MATU = read.table('../../Body/1Raw/FishBaseLmTm.txt')
colnames(MATU)=c("Species", "Lm", "Tm")
MATU$Species=gsub(" ", "_", MATU$Species)
MATUTm=MATU[!is.na(MATU$Tm),]
MATULm=MATU[MATU$Lm != "",]
MATUTm$Lm = NULL
MATULmmut = MATULm
MATULmmut$Tm = NULL
View(MATULmmut)
for (i in 1:nrow(MATULmmut)){
MATULmmut$Lm_value[i]=as.numeric(unlist(strsplit(as.character(MATULmmut$Lm[i]), ' '))[1])
MATULmmut$Lm_measure[i]=unlist(strsplit(as.character(MATULmmut$Lm[i]), ' '))[2]
}
MATULm = MATULmmut
MATULm[is.na(MATU$Tm),] = "NONE"
MATULm[is.na(MATULm)] = "NONE"
View(MATULm)
M = MATULm[MATULm$Lm_measure != "FL",]
View(M)
M = MATULm[MATULm$Lm_measure != "SL",]
M = MATULm[MATULm$Lm_measure != "OT",]
M = MATULm[MATULm$Lm_measure != "WD",]
View(M)
M = MATULm[MATULm$Lm_measure != "FL",]
View(M)
M = MATULm[MATULm$Lm_measure != "SL",]
View(M)
M = MATULm[MATULm$Lm_measure != "FL",]
M = MATULm[MATULm$Lm_measure != "SL",]
M = MATULm[MATULm$Lm_measure != "OT",]
M = MATULm[MATULm$Lm_measure != "WD",]
View(M)
M = MATULm[MATULm$Lm_measure != "FL",]
M = M[M$Lm_measure != "SL",]
M = M[M$Lm_measure != "OT",]
M = M[M$Lm_measure != "WD",]
View(M)
M$Lm = NULL
M$Lm_measure = NULL
setwd('../../Body/1Raw')
write.table(M, file="FishBaseMaturity_Lm.txt", quote = FALSE, row.names = FALSE)
View(MATUTm)
write.table(MATUTm, file="FishBaseMaturity_Tm.txt", quote = FALSE, row.names = FALSE)
rm(list=ls(all=TRUE))
##########MATURITY Lm (mean length at first maturity in  )  and Tm (Mean or median age at first maturity)
MATULM = read.table('../../Body/1Raw/FishBaseMaturity_Lm.txt',  header = TRUE, stringsAsFactors=FALSE)
MATUTM = read.table('../../Body/1Raw/FishBaseMaturity_Tm.txt',  header = TRUE)
class(MATULM$Lm)
MATULM$Lm = as.numeric(MATULM$Lm)
MATUTM = aggregate(Tm ~ ., median, data = MATUTM)
MATULM = aggregate(Lm ~ ., median, data = MATULM)
MATULmmut = merge(MUT,MATULM)
MATUTmmut = merge(MUT,MATUTM)
##########POLYMORHIC MUTSPEC
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
class(MUT$A_T)
class(MUT$Species)
cor.test(MATULmmut$G_C,MATULmmut$Lm, method = 'spearman')   #rho  -0.266859         p-value = 0.008235
MATULmmut = merge(MUT,MATULM)
MATUTmmut = merge(MUT,MATUTM)
cor.test(MATULmmut$G_C,MATULmmut$Lm, method = 'spearman')   #rho  -0.266859         p-value = 0.008235
