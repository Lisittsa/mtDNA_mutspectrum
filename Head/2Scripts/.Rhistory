AGG$CTSkew = (AGG$NeutralC - AGG$NeutralT)/(AGG$NeutralC + AGG$NeutralT); summary(AGG$TCSkew) # GA on heavy
############# GENERATION LENGTH FOR MAMMALS
GT = read.table("../../Body/1Raw/GenerationLenghtforMammals.xlsx.txt", header = TRUE, sep = '\t')
GT$Species = gsub(' ','_',GT$Scientific_name)
length(unique(GT$Species))
summary(GT$AdultBodyMass_g)     # 2        21        71    136058       614 154321304
summary(GT$GenerationLength_d)  # 129.0   624.4  1101.1  1578.8  2064.3 18980.0 # max = 18980 days => 52 years. ok
GT = GT[,c(11,13)]
summary(GT$GenerationLength_d)
M = merge(AGG,GT, by ='Species')
summary(M$GenerationLength_d) # median = 2190.0
ShortLived = unique(M[M$GenerationLength_d <= median(M$GenerationLength_d),]$Species); length(ShortLived)
LongLived = unique(M[M$GenerationLength_d  > median(M$GenerationLength_d),]$Species);  length(LongLived)
MShort = M[M$Species %in% ShortLived,]; MShort$GT = 'short lived'; MLong = M[M$Species %in% LongLived,]; MLong$GT = 'long lived';
M = rbind(MShort,MLong)
M$Gene =  ordered(M$Gene, levels = c('COX1','COX2','ATP8','ATP6','COX3','ND3','ND4L','ND4','ND5','ND6','CytB', 'ND1','ND2'))
# M$Gene =  ordered(M$Gene, levels = c('COX1','COX2','ATP8','ATP6','COX3','ND3','ND4L','ND4','ND5','CytB'))
M = M[order(M$Gene),]
M = M[!M$Gene %in% c('ND6','ND1','ND2'),]
M$Gene =  ordered(M$Gene, levels = c('COX1','COX2','ATP8','ATP6','COX3','ND3','ND4L','ND4','ND5','CytB'))
boxplot(CTSkew ~ GT*Gene, data = M,  notch = TRUE, outline = FALSE, las = 2, col = c('red','green'), main = 'Mammalia, GA skew')
library("ggpubr")
pdf("../../Body/4Figures/WholeGenomeAnalyses.NoOverlap.AGSkew.R.02.pdf", height = 10, width = 20)
ggboxplot(M, "Gene", "CTSkew",
fill = "GT", palette = c("#5c76d6", "#d65c5c"), xlab="Genes", ylab="GA skew", title = "GA skew in long- vs shortlived mammals", legend.title = "Mammals", width = 0.7, notch = TRUE)
dev.off()
library(seqinr)
library(ggplot2)
############ Syn mut
unzip("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt.zip")
SynNuc = read.table("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt", header = TRUE, sep = '\t')
if (file.exists("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt")){file.remove("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt")}
names(SynNuc)
SynNuc = SynNuc[!(SynNuc$Gene %in% c('ND1', 'ND2', 'ND6')),]
GT = read.table("../../Body/1Raw/GenerationLenghtforMammals.xlsx.txt", header = TRUE, sep = '\t')
GT$Species = gsub(' ','_',GT$Scientific_name)
GT = GT[,c(11,13)]
shortestGT = GT[GT$GenerationLength_d == min(GT$GenerationLength_d), 'Species']
longestGT = GT[GT$GenerationLength_d == max(GT$GenerationLength_d), 'Species']
VecOfSynFourFoldDegenerateSites <- c('CTT', 'CTC', 'CTA', 'CTG',
'GTT', 'GTC', 'GTA', 'GTG',
'TCT', 'TCC', 'TCA', 'TCG',
'CCT', 'CCC', 'CCA', 'CCG',
'ACT', 'ACC', 'ACA', 'ACG',
'GCT', 'GCC', 'GCA', 'GCG',
'CGT', 'CGC', 'CGA', 'CGG',
'GGT', 'GGC', 'GGA', 'GGG')
getVecOfThirdNucleotides4f = function(x){
codonsVec = splitseq(s2c(x))
codons4f = codonsVec[codonsVec %in% VecOfSynFourFoldDegenerateSites]
thirdPosList = gsub("CTA|GTA|TCA|CCA|ACA|GCA|CGA|GGA", 'A', codons4f)
thirdPosList = gsub("CTT|GTT|TCT|CCT|ACT|GCT|CGT|GGT", 'T', thirdPosList)
thirdPosList = gsub("CTG|GTG|TCG|CCG|ACG|GCG|CGG|GGG", 'G', thirdPosList)
thirdPosList = gsub("CTC|GTC|TCC|CCC|ACC|GCC|CGC|GGC", 'C', thirdPosList)
thirdPosVec = paste(as.vector(thirdPosList), collapse = '')
return(thirdPosVec)
}
SynNuc$ThirdPos4f = lapply(as.character(SynNuc$CodonsNoOverlap), getVecOfThirdNucleotides4f)
M = merge(SynNuc, GT, by ='Species')
M$Gene =  ordered(M$Gene, levels = c('COX1','COX2','ATP8','ATP6','COX3','ND3','ND4L','ND4','ND5','CytB'))
M = M[order(M$Gene),]
shortestGT = M[M$GenerationLength_d == min(M$GenerationLength_d),]
longestGT = M[M$GenerationLength_d == max(M$GenerationLength_d),]
shortGlVec4f = paste(shortestGT$ThirdPos4f, collapse = '')
longGlVec4f = paste(longestGT$ThirdPos4f, collapse = '')
shortSeq = splitseq(s2c(shortGlVec4f), word = 20)
longSeq = splitseq(s2c(longGlVec4f), word = 20)
nuclCount = function(seq, char){
cnt = nchar(as.character(seq)) - nchar(gsub(char, "", seq))
return(cnt)
}
tCount = sapply(shortSeq, nuclCount, char='T')
cCount = sapply(shortSeq, nuclCount, char='C')
tCountlong = sapply(longSeq, nuclCount, char='T')
cCountlong = sapply(longSeq, nuclCount, char='C')
plot(1:length(tCountlong), tCountlong)
plot(1:length(cCountlong), cCountlong)
shortTC = as.data.frame(cbind(cCount, tCount))
shortTC$cCount = - shortTC$cCount
num = 1:nrow(shortTC)
shortTC = cbind(shortTC, num)
longTC = as.data.frame(cbind(cCountlong, tCountlong))
longTC$cCountlong = - longTC$cCountlong
num = 1:nrow(longTC)
longTC = cbind(longTC, num)
ColG = rgb(0.1,0.1,0.1,0.5)
ColA = rgb(1,0.1,0.1,0.5)
a = ggplot(shortTC, aes(num, tCount)) +
geom_bar(fill = ColA, color = 'white', stat = "identity") +
geom_bar(aes(num, cCount), fill = ColG, color = 'white', stat = "identity") +
ggtitle('low Generation time') + xlab('Position') + ylab('') +
scale_fill_discrete(name = "Nucleotide", labels = c("G", "A")) +
theme_classic(); a
a = ggplot(longTC, aes(num, tCountlong)) +
geom_bar(fill = ColA, color = 'white', stat = "identity") +
geom_bar(aes(num, cCountlong), fill = ColG, color = 'white', stat = "identity") +
ggtitle('high Generation time') + xlab('Position') + ylab('') +
scale_fill_discrete(name = "Nucleotide", labels = c("G", "A")) +
theme_classic(); a
shortTC = as.data.frame(cbind(cCount, tCount))
shortTC$cCount = - shortTC$cCount
num = 1:nrow(shortTC)
shortTC = cbind(shortTC, num)
longTC = as.data.frame(cbind(cCountlong, tCountlong))
longTC$cCountlong = - longTC$cCountlong
num = 1:nrow(longTC)
longTC = cbind(longTC, num)
p <- ggplot(shortTC, aes(x=num, y=tCount)) +       # Note that id is a factor. If x is numeric, there is some space between the first bar
# This add the bars with a blue color
geom_bar(fill = ColA, color = 'white', stat="identity") +
geom_bar(aes(num, cCount), fill = ColG, color = 'white', stat = "identity") +
# Limits of the plot = very important. The negative value controls the size of the inner circle, the positive one is useful to add size over each bar
ylim(-20, 20) +
# Custom the theme: no axis title and no cartesian grid
theme_minimal() +
theme(
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-2,4), "cm")     # This remove unnecessary margin around plot
) +
# This makes the coordinate polar instead of cartesian.
coord_polar(start = 0) + scale_fill_discrete(name = "Nucleotide", labels = c("G", "A"))
p <- ggplot(longTC, aes(x=num, y=tCountlong)) +       # Note that id is a factor. If x is numeric, there is some space between the first bar
# This add the bars with a blue color
geom_bar(stat="identity", fill = ColA, color = 'white') +
geom_bar(aes(num, cCountlong), fill = ColG, color = 'white', stat = "identity") +
# Limits of the plot = very important. The negative value controls the size of the inner circle, the positive one is useful to add size over each bar
ylim(-20, 20) +
# Custom the theme: no axis title and no cartesian grid
theme_minimal() +
theme(
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-2,4), "cm")     # This remove unnecessary margin around plot
) +
# This makes the coordinate polar instead of cartesian.
coord_polar(start = 0) +
scale_fill_discrete(name = "Nucleotide", labels = c("G", "A"))
shortTC = as.data.frame(cbind(cCount, tCount))
shortTC$cCount = - shortTC$cCount
a = as.data.frame(matrix(0, ncol = 2, nrow = 40))
names(a) = names(shortTC)
shortTC = rbind(shortTC, a)
num = 1:nrow(shortTC)
shortTC = cbind(shortTC, num)
longTC = as.data.frame(cbind(cCountlong, tCountlong))
longTC$cCountlong = - longTC$cCountlong
a = as.data.frame(matrix(0, ncol = 2, nrow = 42))
names(a) = names(longTC)
longTC = rbind(longTC, a)
num = 1:nrow(longTC)
longTC = cbind(longTC, num)
p <- ggplot(shortTC, aes(x=num, y=tCount)) +       # Note that id is a factor. If x is numeric, there is some space between the first bar
# This add the bars with a blue color
geom_bar(stat="identity", fill = ColA, color = 'white') +
geom_bar(aes(num, cCount), fill = ColG, color = 'white', stat = "identity") +
# Limits of the plot = very important. The negative value controls the size of the inner circle, the positive one is useful to add size over each bar
ylim(-20, 20) +
# Custom the theme: no axis title and no cartesian grid
theme_minimal() +
theme(
#plot.title = element_text('Tarsipes rostratus, 341.275')
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank()
# plot.margin = unit(rep(-1,4), "cm")     # This remove unnecessary margin around plot
) +
# This makes the coordinate polar instead of cartesian.
coord_polar(start = 3*pi/4, direction = -1) +
scale_fill_discrete(name = "Nucleotide", labels = c("G", "A"))
print(p + labs(title = 'Tarsipes rostratus, 341 days'))
p <- ggplot(longTC, aes(x=num, y=tCountlong)) +       # Note that id is a factor. If x is numeric, there is some space between the first bar
# This add the bars with a blue color
geom_bar(stat="identity", fill = ColA, color = 'white') +
geom_bar(aes(num, cCountlong), fill = ColG, color = 'white', stat = "identity") +
# Limits of the plot = very important. The negative value controls the size of the inner circle, the positive one is useful to add size over each bar
ylim(-20, 20) +
# Custom the theme: no axis title and no cartesian grid
theme_minimal() +
theme(
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank()
# plot.margin = unit(rep(-2,4), "cm")     # This remove unnecessary margin around plot
) +
# This makes the coordinate polar instead of cartesian.
coord_polar(start = 3*pi/4, direction = -1) +
scale_fill_discrete(name = "Nucleotide", labels = c("G", "A"))
p + ggtitle('Balaena mysticetus, 18980 days')
shortTC = as.data.frame(cbind(cCount, tCount))
shortTC$cCount = - shortTC$cCount
a = as.data.frame(matrix(0, ncol = 2, nrow = 40))
names(a) = names(shortTC)
shortTC = rbind(shortTC, a)
num = 1:nrow(shortTC)
shortTC = cbind(shortTC, num)
longTC = as.data.frame(cbind(cCountlong, tCountlong))
longTC$cCountlong = - longTC$cCountlong
a = as.data.frame(matrix(0, ncol = 2, nrow = 35))
names(a) = names(longTC)
longTC = rbind(longTC, a)
num = 1:nrow(longTC)
longTC = cbind(longTC, num)
shortTC = as.data.frame(cbind(cCount, tCount))
shortTC$cCount = - shortTC$cCount
a = as.data.frame(matrix(0, ncol = 2, nrow = 40))
names(a) = names(shortTC)
shortTC = rbind(shortTC, a)
num = 1:nrow(shortTC)
shortTC = cbind(shortTC, num)
longTC = as.data.frame(cbind(cCountlong, tCountlong))
longTC$cCountlong = - longTC$cCountlong
a = as.data.frame(matrix(0, ncol = 2, nrow = 35))
names(a) = names(longTC)
longTC = rbind(longTC, a)
num = 1:nrow(longTC)
longTC = cbind(longTC, num)
p <- ggplot(shortTC, aes(x=num, y=tCount)) +       # Note that id is a factor. If x is numeric, there is some space between the first bar
# This add the bars with a blue color
geom_bar(stat="identity", fill = ColA, color = 'white') +
geom_bar(aes(num, cCount), fill = ColG, color = 'white', stat = "identity") +
# Limits of the plot = very important. The negative value controls the size of the inner circle, the positive one is useful to add size over each bar
ylim(-20, 20) +
# Custom the theme: no axis title and no cartesian grid
theme_minimal() +
theme(
#plot.title = element_text('Tarsipes rostratus, 341.275')
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank()
# plot.margin = unit(rep(-1,4), "cm")     # This remove unnecessary margin around plot
) +
# This makes the coordinate polar instead of cartesian.
coord_polar(start = 3*pi/4, direction = -1) +
scale_fill_discrete(name = "Nucleotide", labels = c("G", "A"))
print(p + labs(title = 'Tarsipes rostratus, 341 days'))
p <- ggplot(longTC, aes(x=num, y=tCountlong)) +       # Note that id is a factor. If x is numeric, there is some space between the first bar
# This add the bars with a blue color
geom_bar(stat="identity", fill = ColA, color = 'white') +
geom_bar(aes(num, cCountlong), fill = ColG, color = 'white', stat = "identity") +
# Limits of the plot = very important. The negative value controls the size of the inner circle, the positive one is useful to add size over each bar
ylim(-20, 20) +
# Custom the theme: no axis title and no cartesian grid
theme_minimal() +
theme(
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank()
# plot.margin = unit(rep(-2,4), "cm")     # This remove unnecessary margin around plot
) +
# This makes the coordinate polar instead of cartesian.
coord_polar(start = 3*pi/4, direction = -1) +
scale_fill_discrete(name = "Nucleotide", labels = c("G", "A"))
p + ggtitle('Balaena mysticetus, 18980 days')
shortTC = as.data.frame(cbind(cCount, tCount))
shortTC$cCount = - shortTC$cCount
num = 1:nrow(shortTC)
shortTC = cbind(shortTC, num)
longTC = as.data.frame(cbind(cCountlong, tCountlong))
longTC$cCountlong = - longTC$cCountlong
num = 1:nrow(longTC)
longTC = cbind(longTC, num)
pdf('../../Body/4Figures/WholeGenomeAnalyses.NoOverlapAgAlongGenome.pdf')
ColG = rgb(0.1,0.1,0.1,0.5)
ColA = rgb(1,0.1,0.1,0.5)
a = ggplot(shortTC, aes(num, tCount)) +
geom_bar(fill = ColA, color = 'white', stat = "identity") +
geom_bar(aes(num, cCount), fill = ColG, color = 'white', stat = "identity") +
ggtitle('low Generation time') + xlab('Position') + ylab('') +
scale_fill_discrete(name = "Nucleotide", labels = c("G", "A")) +
theme_classic(); a
a = ggplot(longTC, aes(num, tCountlong)) +
geom_bar(fill = ColA, color = 'white', stat = "identity") +
geom_bar(aes(num, cCountlong), fill = ColG, color = 'white', stat = "identity") +
ggtitle('high Generation time') + xlab('Position') + ylab('') +
scale_fill_discrete(name = "Nucleotide", labels = c("G", "A")) +
theme_classic(); a
# dev.off()
shortTC = as.data.frame(cbind(cCount, tCount))
shortTC$cCount = - shortTC$cCount
num = 1:nrow(shortTC)
shortTC = cbind(shortTC, num)
longTC = as.data.frame(cbind(cCountlong, tCountlong))
longTC$cCountlong = - longTC$cCountlong
num = 1:nrow(longTC)
longTC = cbind(longTC, num)
p <- ggplot(shortTC, aes(x=num, y=tCount)) +       # Note that id is a factor. If x is numeric, there is some space between the first bar
# This add the bars with a blue color
geom_bar(fill = ColA, color = 'white', stat="identity") +
geom_bar(aes(num, cCount), fill = ColG, color = 'white', stat = "identity") +
# Limits of the plot = very important. The negative value controls the size of the inner circle, the positive one is useful to add size over each bar
ylim(-20, 20) +
# Custom the theme: no axis title and no cartesian grid
theme_minimal() +
theme(
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-2,4), "cm")     # This remove unnecessary margin around plot
) +
# This makes the coordinate polar instead of cartesian.
coord_polar(start = 0) + scale_fill_discrete(name = "Nucleotide", labels = c("G", "A"))
# p
p <- ggplot(longTC, aes(x=num, y=tCountlong)) +       # Note that id is a factor. If x is numeric, there is some space between the first bar
# This add the bars with a blue color
geom_bar(stat="identity", fill = ColA, color = 'white') +
geom_bar(aes(num, cCountlong), fill = ColG, color = 'white', stat = "identity") +
# Limits of the plot = very important. The negative value controls the size of the inner circle, the positive one is useful to add size over each bar
ylim(-20, 20) +
# Custom the theme: no axis title and no cartesian grid
theme_minimal() +
theme(
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank(),
plot.margin = unit(rep(-2,4), "cm")     # This remove unnecessary margin around plot
) +
# This makes the coordinate polar instead of cartesian.
coord_polar(start = 0) +
scale_fill_discrete(name = "Nucleotide", labels = c("G", "A"))
# p
############################################################
### add zeros
shortTC = as.data.frame(cbind(cCount, tCount))
shortTC$cCount = - shortTC$cCount
a = as.data.frame(matrix(0, ncol = 2, nrow = 40))
names(a) = names(shortTC)
shortTC = rbind(shortTC, a)
num = 1:nrow(shortTC)
shortTC = cbind(shortTC, num)
longTC = as.data.frame(cbind(cCountlong, tCountlong))
longTC$cCountlong = - longTC$cCountlong
a = as.data.frame(matrix(0, ncol = 2, nrow = 35))
names(a) = names(longTC)
longTC = rbind(longTC, a)
num = 1:nrow(longTC)
longTC = cbind(longTC, num)
p <- ggplot(shortTC, aes(x=num, y=tCount)) +       # Note that id is a factor. If x is numeric, there is some space between the first bar
# This add the bars with a blue color
geom_bar(stat="identity", fill = ColA, color = 'white') +
geom_bar(aes(num, cCount), fill = ColG, color = 'white', stat = "identity") +
# Limits of the plot = very important. The negative value controls the size of the inner circle, the positive one is useful to add size over each bar
ylim(-20, 20) +
# Custom the theme: no axis title and no cartesian grid
theme_minimal() +
theme(
#plot.title = element_text('Tarsipes rostratus, 341.275')
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank()
# plot.margin = unit(rep(-1,4), "cm")     # This remove unnecessary margin around plot
) +
# This makes the coordinate polar instead of cartesian.
coord_polar(start = 3*pi/4, direction = -1) +
scale_fill_discrete(name = "Nucleotide", labels = c("G", "A"))
print(p + labs(title = 'Tarsipes rostratus, 341 days'))
p <- ggplot(longTC, aes(x=num, y=tCountlong)) +       # Note that id is a factor. If x is numeric, there is some space between the first bar
# This add the bars with a blue color
geom_bar(stat="identity", fill = ColA, color = 'white') +
geom_bar(aes(num, cCountlong), fill = ColG, color = 'white', stat = "identity") +
# Limits of the plot = very important. The negative value controls the size of the inner circle, the positive one is useful to add size over each bar
ylim(-20, 20) +
# Custom the theme: no axis title and no cartesian grid
theme_minimal() +
theme(
axis.text = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank()
# plot.margin = unit(rep(-2,4), "cm")     # This remove unnecessary margin around plot
) +
# This makes the coordinate polar instead of cartesian.
coord_polar(start = 3*pi/4, direction = -1) +
scale_fill_discrete(name = "Nucleotide", labels = c("G", "A"))
p + ggtitle('Balaena mysticetus, 18980 days')
dev.off()
rm(list=ls(all=TRUE))
############ Syn mut
unzip("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt.zip", exdir = "../../Body/3Results/")
SynNuc = read.table("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt", header = TRUE, sep = '\t')
SynNuc = read.table("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt", header = TRUE, sep = '\t')
if (file.exists("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt")){ file.remove("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt")}
View(SynNuc)
# SynNuc = read.table("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt", header = TRUE)
names(SynNuc)
VecOfTaxa = unique(SynNuc$Class)
VecOfTaxa
table(SynNuc$Class)/13
View(SynNuc)
table(SynNuc$Class)/13
table(SynNuc$Class)
names(SynNuc)
############ AnAge
AA = read.table("../../Body/1Raw/anage_data.txt", header = TRUE, sep = '\t')
AA$Species = paste(AA$Genus,AA$Species,sep = '_')
View(AA)
View(SynNuc)
View(AA)
View(AA)
Alldata =  merge(SynNuc, AA, by = 'Species')
View(Alldata)
View(Alldata)
names(Alldata)
table(Alldata$Class.x)
table(Alldata$Class.y)
Mammalia = Alldata[Alldata$Class.y == "Mammalia",]
table(Mammalia)
table(Mammalia$Order)
names(Alldata)
table(Mammalia$Phylum)
names(Mammalia$Order)
table(Mammalia$Order)
Marsupials = Mammalia[Mammalia$Order %in% vec_of_Marsupials_orders,]
vec_of_Marsupials_orders = c("Dasyuromorphia", 'Didelphimorphia', "Diprotodontia", "Microbiotheria", "Notoryctemorphia", "Paucituberculata", "Peramelemorphia")
Marsupials = Mammalia[Mammalia$Order %in% vec_of_Marsupials_orders,]
table(Marsupials$Order)
Marsupials
View(Marsupials)
names(Marsupials)
table(Marsupials$Order)
rm(list=ls(all=TRUE))
############ Syn mut
unzip("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt.zip", exdir = "../../Body/3Results/")
SynNuc = read.table("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt", header = TRUE, sep = '\t')
############ Syn mut
unzip("../../Body/3Results/AllGenesCodonUsageNoOverlap.zip", exdir = "../../Body/3Results/")
############ Syn mut
unzip("../../Body/3Results/AllGenesCodonUsageNoOverlap.zip")
############ Syn mut
unzip("../../Body/3Results/AllGenesCodonUsageNoOverlap.rar")
rm(list=ls(all=TRUE))
############ Syn mut
SynNuc = read.table("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt", header = TRUE, sep = '\t')
############ Syn mut
SynNuc = read.table("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt", header = TRUE, sep = '\t')
if (file.exists("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt")){file.remove("../../Body/3Results/AllGenesCodonUsageNoOverlap.txt")}
names(SynNuc)
############ AnAge
AA = read.table("../../Body/1Raw/anage_data.txt", header = TRUE, sep = '\t')
AA$Species = paste(AA$Genus,AA$Species,sep = '_')
Alldata =  merge(SynNuc, AA, by = 'Species')
names(Alldata)
Mammalia = Alldata[Alldata$Class.y == "Mammalia",]
vec_of_Marsupials_orders = c("Dasyuromorphia", 'Didelphimorphia', "Diprotodontia", "Microbiotheria", "Notoryctemorphia", "Paucituberculata", "Peramelemorphia")
Marsupials = Mammalia[Mammalia$Order %in% vec_of_Marsupials_orders,]
table(Marsupials$Order)
Monotremata = Mammalia[Mammalia$Order == "Monotremata",]
Monotremata
table(Monotremata$Order)
for (i in 1:nrows(Mammalia)){
if (Mammalia$Order[i] %in% vec_of_Marsupials_orders){
Mammalia$Subdivision[i] = "Marsupials"
}else{
Mammalia$Subdivision[i] = "nonMarsupials"
}
}
for (i in 1:nrow(Mammalia)){
if (Mammalia$Order[i] %in% vec_of_Marsupials_orders){
Mammalia$Subdivision[i] = "Marsupials"
}else{
Mammalia$Subdivision[i] = "nonMarsupials"
}
}
names(Mammalia)
table(Mammalia$Subdivision)
for (i in 1:nrow(Mammalia)){
if (Mammalia$Subdivision[i] == "nonMarsupials"){
if (Mammalia$Order[i] == "Monotremata"){
Mammalia$Subdivision[i] = "Monotremata"
}else{
Mammalia$Subdivision[i] = "Placentals"
}
}
}
table(Mammalia$Subdivision)
library(ggpubr)
ggboxplot(Mammalia, "Subdivision", "NeutralA",
fill = "Subdivision", palette =c("#00AFBB", "#E7B800", "#FC4E07"))
ggboxplot(Mammalia, "Subdivision", "NeutralC",
fill = "Subdivision", palette =c("#00AFBB", "#E7B800", "#FC4E07"))
ggboxplot(Mammalia, "Subdivision", "NeutralT",
fill = "Subdivision", palette =c("#00AFBB", "#E7B800", "#FC4E07"))
ggboxplot(Mammalia, "Subdivision", "NeutralC",
fill = "Subdivision", palette =c("#00AFBB", "#E7B800", "#FC4E07"))
ggboxplot(Mammalia, "Subdivision", "Maximum.longevity..yrs.",
fill = "Subdivision", palette =c("#00AFBB", "#E7B800", "#FC4E07"))
ggboxplot(Mammalia, "Subdivision", "Maximum.longevity..yrs.",
ggboxplot(Mammalia, "Subdivision", "Maximum.longevity..yrs.",
ggboxplot(Mammalia, "Subdivision", "Maximum.longevity..yrs.",
ggboxplot(Mammalia, "Subdivision", "Maximum.longevity..yrs.",
fill = "Subdivision", palette =c("#e34a33", "#fdbb84", "#fee8c8"))
ggboxplot(Mammalia, "Subdivision", "NeutralT",
fill = "Subdivision", palette =c("#2b8cbe", "#a6bddb", "#ece7f2"))
ggboxplot(Mammalia, "Subdivision", "NeutralC",
ggboxplot(Mammalia, "Subdivision", "NeutralC", fill = "Subdivision", palette =c("#2ca25f", "#99d8c9", "#e5f5f9"))
ggboxplot(Mammalia, "Subdivision", "Maximum.longevity..yrs.", fill = "Subdivision", palette =c("#e34a33", "#fdbb84", "#fee8c8"))
pdf("../../Body/4Figures/WholeGenomeAnalyses.NoOverlap.Placentals_Monotremata_Marsupials_A_G_Longevity.pdf", height = 20, width = 40)
ggboxplot(Mammalia, "Subdivision", "NeutralT",
fill = "Subdivision", palette =c("#2b8cbe", "#a6bddb", "#ece7f2"))
ggboxplot(Mammalia, "Subdivision", "NeutralC", fill = "Subdivision", palette =c("#2ca25f", "#99d8c9", "#e5f5f9"))
ggboxplot(Mammalia, "Subdivision", "Maximum.longevity..yrs.", fill = "Subdivision", palette =c("#e34a33", "#fdbb84", "#fee8c8"))
dev.off()
ggboxplot(Mammalia, "Subdivision", "Maximum.longevity..yrs.", fill = "Subdivision", palette =c("#e34a33", "#fdbb84", "#fee8c8"))
table(Mammalia$Subdivision)
Mammalia$
library(ggpubr)
Mammalia$Maximum.longevity..yrs.
Mammalia= Mammalia[!is.na(Mammalia$Maximum.longevity..yrs.),]
ggboxplot(Mammalia, "Subdivision", "Maximum.longevity..yrs.", fill = "Subdivision", palette =c("#e34a33", "#fdbb84", "#fee8c8"))
install.packages("ape")
install.packages(c("caper", "pacman"))
