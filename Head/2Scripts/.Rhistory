rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
AnAge = read.table('../../Body/1Raw/anage_data.txt', sep = '\t', header = TRUE)
AnAge$Species = paste(AnAge$Genus,AnAge$Species,sep = '_')
AnAge = AnAge[AnAge$Class == 'Actinopterygii',]
AnAgeMut = merge(MUT,AnAge) # 110
Temper = read.table('../../Body/1Raw/BodyParametersForAllClasses.txt',header = TRUE)
table(Temper$Class)
Temper = Temper[Temper$Class == 'Actinopterygii',]
TemperMut = merge(MUT,Temper) # 320 species!!!
TemperMut$T_C.NormalOnlyByT = TemperMut$T_C / (TemperMut$T_C  + TemperMut$T_A + TemperMut$T_G )
###### Temperature, Mass, MetabolRate
###### Temperature ~ T_C
cor.test(TemperMut$T_C,TemperMut$Temperature, method = 'spearman') # super positive!!!! rho = 0.566
install.packages("ggpubr")
library("ggpubr")
plotTCtemp = ggscatter(TemperMut, x = "Temperature", y = "T_C",
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "spearman",
xlab = "Temperature", ylab = "T_C")
plotTCtemp
plotTCtemp = ggscatter(TemperMut, x = "Temperature", y = "T_C",
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "spearman",
xlab = "Temperature", ylab = "A>G")
plotTCtemp = ggscatter(TemperMut, x = "Temperature", y = "T_C",
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "spearman",
xlab = "Temperature", ylab = "A>G")
plotTCtemp
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
View(MUT)
AnAge = read.table('../../Body/1Raw/anage_data.txt', sep = '\t', header = TRUE)
AnAge$Species = paste(AnAge$Genus,AnAge$Species,sep = '_')
AnAge = AnAge[AnAge$Class == 'Actinopterygii',]
AnAgeMut = merge(MUT,AnAge) # 110
cor.test(AnAgeMut$A_T,AnAgeMut$Maximum.longevity..yrs., method = 'spearman')
cor.test(AnAgeMut$A_G,AnAgeMut$Maximum.longevity..yrs., method = 'spearman')
cor.test(AnAgeMut$A_C,AnAgeMut$Maximum.longevity..yrs., method = 'spearman')
cor.test(AnAgeMut$T_A,AnAgeMut$Maximum.longevity..yrs., method = 'spearman')
cor.test(AnAgeMut$T_G,AnAgeMut$Maximum.longevity..yrs., method = 'spearman')
cor.test(AnAgeMut$T_C,AnAgeMut$Maximum.longevity..yrs., method = 'spearman')
cor.test(AnAgeMut$G_A,AnAgeMut$Maximum.longevity..yrs., method = 'spearman')
cor.test(AnAgeMut$G_T,AnAgeMut$Maximum.longevity..yrs., method = 'spearman')
cor.test(AnAgeMut$G_C,AnAgeMut$Maximum.longevity..yrs., method = 'spearman')
cor.test(AnAgeMut$C_A,AnAgeMut$Maximum.longevity..yrs., method = 'spearman')
cor.test(AnAgeMut$C_T,AnAgeMut$Maximum.longevity..yrs., method = 'spearman')
cor.test(AnAgeMut$C_G,AnAgeMut$Maximum.longevity..yrs., method = 'spearman')
Temper = read.table('../../Body/1Raw/BodyParametersForAllClasses.txt',header = TRUE)
View(MUT)
View(Temper)
table(Temper$Class)
Temper = Temper[Temper$Class == 'Actinopterygii',]
TemperMut = merge(MUT,Temper) # 320 species!!!
TemperMut$T_C.NormalOnlyByT = TemperMut$T_C / (TemperMut$T_C  + TemperMut$T_A + TemperMut$T_G )
View(TemperMut)
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
Temper = read.table('../../Body/1Raw/BodyParametersForAllClasses.txt',header = TRUE)
table(Temper$Class)
Temper = Temper[Temper$Class == 'Actinopterygii',]
TemperMut = merge(MUT,Temper) # 320 species!!!
TemperMut$T_C.NormalOnlyByT = TemperMut$T_C / (TemperMut$T_C  + TemperMut$T_A + TemperMut$T_G )
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
Temper = read.table('../../Body/1Raw/BodyParametersForAllClasses.txt',header = TRUE)
table(Temper$Class)
Temper = Temper[Temper$Class == 'Actinopterygii',]
TemperMut = merge(MUT,Temper) # 320 species!!!
View(TemperMut)
View(MUT)
View(TemperMut)
View(Temper)
View(Temper)
View(TemperMut)
View(MUT)
View(Temper)
AnAge = read.table('../../Body/1Raw/anage_data.txt', sep = '\t', header = TRUE)
AnAge$Species = paste(AnAge$Genus,AnAge$Species,sep = '_')
AnAge = AnAge[AnAge$Class == 'Actinopterygii',]
AnAgeMut = merge(MUT,AnAge)
View(AnAge)
Taxa = read.table("../../Body/1Raw/TaxaFromKostya.Names.stat", sep = '\t',header = FALSE)
Taxa$Species = gsub(";.*",'',Taxa$V1);
for (i in (1:nrow(Taxa)))  {Taxa$Species[i] = paste(unlist(strsplit(as.character(Taxa$Species[i]),split = ' '))[1],unlist(strsplit(as.character(Taxa$Species[i]),split = ' '))[2], sep = '_')}
Taxa$Class = gsub(";Chordata;.*",'',Taxa$V1); Taxa$Class = gsub(".*;",'',Taxa$Class); table(Taxa$Class)
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
Taxa = read.table("../../Body/1Raw/TaxaFromKostya.Names.stat", sep = '\t',header = FALSE)
Taxa$Species = gsub(";.*",'',Taxa$V1);
for (i in (1:nrow(Taxa)))  {Taxa$Species[i] = paste(unlist(strsplit(as.character(Taxa$Species[i]),split = ' '))[1],unlist(strsplit(as.character(Taxa$Species[i]),split = ' '))[2], sep = '_')}
Taxa$Class = gsub(";Chordata;.*",'',Taxa$V1); Taxa$Class = gsub(".*;",'',Taxa$Class); table(Taxa$Class)
Taxa$Class = gsub('Actinopteri','Actinopterygii',Taxa$Class)
Taxa$Class = gsub("Testudines|Squamata|Crocodylia|Sphenodontia",'Reptilia',Taxa$Class)
length(unique(Taxa$Species)) # 1708
table(Taxa$Class)
Taxa = Taxa[,-1]
### Taxa 2, Cut out the third word!!!!!!!!!!!!!!!!!
TaxaMore = read.table("../../Body/1Raw/TaxaFromKostya.2NeedTaxa.tax.txt", sep = '\t',header = FALSE)
TaxaMore$Species = ''
for (i in (1:nrow(TaxaMore)))
{TaxaMore$Species[i] = paste(unlist(strsplit(as.character(TaxaMore$V1[i]),split = ' '))[1],unlist(strsplit(as.character(TaxaMore$V1[i]),split = ' '))[2], sep = '_')}
TaxaMore$Class = gsub("; Chordata;.*",'',TaxaMore$V2);
TaxaMore$Class = gsub(".*; ",'',TaxaMore$Class);
TaxaMore$Class = gsub('Actinopteri','Actinopterygii',TaxaMore$Class)
TaxaMore$Class = gsub("Testudines|Squamata|Crocodylia",'Reptilia',TaxaMore$Class)
table(TaxaMore$Class)
TaxaMore = TaxaMore[,-c(1,2)]
Taxa = rbind(Taxa,TaxaMore); Taxa = unique(Taxa)
Final = merge(Mut,Taxa)
Final = merge(MUT,Taxa)
Final
View(MUT)
View(Final)
FinalFishes = Final[Final$Class == "Actinopterigii",]
View(FinalFishes)
View(Final)
FinalFishes = Final[Final$Class == "Actinopterygii",]
View(FinalFishes)
MUTwithTAX = merge(MUT,Taxa)
FinalFishes = MUTwithTAX[MUTwithTAX$Class == "Actinopterygii",]
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
TEMPE = read.table('../../Body/1Raw/FishBaseTemperatures.txt', header = TRUE)
View(TEMPE)
View(MUT)
View(TEMPE)
TEMPE = read.table('../../Body/1Raw/FishBaseTemperatures.txt', header = FALSE)
TEMPE$V1 = gsub(" ","_",TEMPE$V1)
TemperMut = merge(MUT,TEMPE) # 320 species!!!
View(TemperMut)
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
TEMPE = read.table('../../Body/1Raw/FishBaseTemperatures.txt', header = FALSE)
TEMPE$V1 = gsub(" ","_",TEMPE$V1)
#########Derining taxonomy################################
Taxa = read.table("../../Body/1Raw/TaxaFromKostya.Names.stat", sep = '\t',header = FALSE)
Taxa$Species = gsub(";.*",'',Taxa$V1);
for (i in (1:nrow(Taxa)))  {Taxa$Species[i] = paste(unlist(strsplit(as.character(Taxa$Species[i]),split = ' '))[1],unlist(strsplit(as.character(Taxa$Species[i]),split = ' '))[2], sep = '_')}
Taxa$Class = gsub(";Chordata;.*",'',Taxa$V1); Taxa$Class = gsub(".*;",'',Taxa$Class); table(Taxa$Class)
Taxa$Class = gsub('Actinopteri','Actinopterygii',Taxa$Class)
Taxa$Class = gsub("Testudines|Squamata|Crocodylia|Sphenodontia",'Reptilia',Taxa$Class)
length(unique(Taxa$Species)) # 1708
table(Taxa$Class)
Taxa = Taxa[,-1]
TaxaMore = read.table("../../Body/1Raw/TaxaFromKostya.2NeedTaxa.tax.txt", sep = '\t',header = FALSE)
TaxaMore$Species = ''
for (i in (1:nrow(TaxaMore)))
{TaxaMore$Species[i] = paste(unlist(strsplit(as.character(TaxaMore$V1[i]),split = ' '))[1],unlist(strsplit(as.character(TaxaMore$V1[i]),split = ' '))[2], sep = '_')}
TaxaMore$Class = gsub("; Chordata;.*",'',TaxaMore$V2);
TaxaMore$Class = gsub(".*; ",'',TaxaMore$Class);
TaxaMore$Class = gsub('Actinopteri','Actinopterygii',TaxaMore$Class)
TaxaMore$Class = gsub("Testudines|Squamata|Crocodylia",'Reptilia',TaxaMore$Class)
table(TaxaMore$Class)
TaxaMore = TaxaMore[,-c(1,2)]
Taxa = rbind(Taxa,TaxaMore); Taxa = unique(Taxa)
MUTwithTAX = merge(MUT,Taxa)
FinalFishes = MUTwithTAX[MUTwithTAX$Class == "Actinopterygii",]
### temperature in fishes:
spe = FinalFishes$Species
spe
TEMPEUS = TEMPE[TEMPE$V1 %in% spe,]
TEMPEUS
View(TEMPEUS)
FinalFishes
View(FinalFishes)
TEMPERMUT = merge(FinalFishes,TEMPERUS)
TEMPERMUT = merge(FinalFishes,TEMPEUS)
View(TEMPERMUT)
TEMPE = read.table('../../Body/1Raw/FishBaseTemperatures.txt', header = FALSE)
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
TEMPE = read.table('../../Body/1Raw/FishBaseTemperatures.txt', header = FALSE)
TEMPE$V1 = gsub(" ","_",TEMPE$V1)
View(MUT)
View(TEMPE)
View(MUT)
View(TEMPE)
View(MUT)
TEMPE
TEMPE = colnames(c("Species", "Temperature"))
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
TEMPE = read.table('../../Body/1Raw/FishBaseTemperatures.txt', header = FALSE)
TEMPE$V1 = gsub(" ","_",TEMPE$V1)
names(TEMPE) = c("Species", "Temperature")
View(TEMPE)
TemperMutALYA = merge(MUT,TEMPE)
View(TemperMutALYA)
TEMPE$Temperature = as.factor(TEMPE$Temperature)
TemperMutALYA = merge(MUT,TEMPE)   # 1170 rows
View(TemperMutALYA)
TEMPE$Temperature = as.numeric(TEMPE$Temperature)
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
TEMPE = read.table('../../Body/1Raw/FishBaseTemperatures.txt', header = FALSE)
TEMPE$V1 = gsub(" ","_",TEMPE$V1)
names(TEMPE) = c("Species", "Temperature")
TEMPE$Temperature = as.numeric(TEMPE$Temperature)
View(TEMPE)
TemperMutALYA = merge(MUT,TEMPE)   # 1170 rows
View(TemperMutALYA)
View(MUT)
View(TemperMutALYA)
View(MUT)
View(MUT)
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
class(MUT$A_T)
TEMPE = read.table('../../Body/1Raw/FishBaseTemperatures.txt', header = FALSE)
TEMPE$V1 = gsub(" ","_",TEMPE$V1)
names(TEMPE) = c("Species", "Temperature")
class(TEMPE$Temperature)
class(MUT$Species)
class(TEMPE$Species)
MUT = as.character(MUT$Species)
class(MUT$Species)
MUT = as.character(MUT$Species)
MUT$Species = as.character(MUT$Species)
for (i in 1:length(MUT)){
MUT$Species[i]=as.character(MUT$Species[i])
}
rm(list=ls(all=TRUE))
MUT = data.frame('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE, stringsAsFactors=FALSE)
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
MUT = data.frame(MUT, stringsAsFactors=FALSE)
class(MUT$A_T)
class(MUT$Species)
MUT = data.frame(MUT, stringsAsFactors=FALSE)
class(MUT$A_T)
class(MUT$Species)
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
MUT = data.frame(MUT, stringsAsFactors=FALSE)
class(MUT$A_T)
class(MUT$Species)
MUT = lapply(MUT$Species, as.character)
class(MUT$Species)
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
MUT = lapply(MUT$Species, as.character)
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
MUT = lapply(MUT, as.character)
rm(list=ls(all=TRUE))
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE, colClasses=c('character'))
class(MUT$A_T)
class(MUT$Species)
MUT = as.numeric(MUT$A_T)
class(MUT$A_T)
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE, colClasses=c('character'))
class(MUT$Species)
class(MUT)
MUT = data.frame(MUT)
class(MUT)
class(MUT$Species)
class(MUT$A_T)
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
MUT = data.frame(
lapply(split(MUT, col(MUT)), type.convert, as.is = TRUE),
stringsAsFactors = FALSE
)
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
MUT = data.frame(lapply(split(MUT, col(MUT)), type.convert, as.is = TRUE), stringsAsFactors = FALSE)
Temper = read.table('../../Body/1Raw/BodyParametersForAllClasses.txt',header = TRUE)
table(Temper$Class)
Temper = Temper[Temper$Class == 'Actinopterygii',]
class(Temper$Species)
TEMPE = read.table('../../Body/1Raw/FishBaseTemperatures.txt', header = FALSE)
class(TEMPE$Species)
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
class(MUT$A_T)
class(MUT$Species)
TEMPE = read.table('../../Body/1Raw/FishBaseTemperatures.txt', header = FALSE)
TEMPE$V1 = gsub(" ","_",TEMPE$V1)
names(TEMPE) = c("Species", "Temperature")
class(TEMPE$Temperature)
class(TEMPE$Species)
TEMPE = data.frame(Col1= as.factor(TEMPE[,1]), Col2=as.numeric(TEMPE[,2]))
class(TEMPE$Temperature)
class(TEMPE$Species)
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
TEMPE = read.table('../../Body/1Raw/FishBaseTemperatures.txt', header = FALSE)
TEMPE$V1 = gsub(" ","_",TEMPE$V1)
names(TEMPE) = c("Species", "Temperature")
class(TEMPE$Temperature)
class(TEMPE$Species)
TEMPE = data.frame(Col1=as.factor(TEMPE[,1]), Col2=as.numeric(TEMPE[,2]))
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
class(MUT$A_T)
class(MUT$Species)
TEMPE = read.table('../../Body/1Raw/FishBaseTemperatures.txt', header = FALSE)
TEMPE$V1 = gsub(" ","_",TEMPE$V1)
names(TEMPE) = c("Species", "Temperature")
class(TEMPE$Temperature)
class(TEMPE$Species)
a <- data.frame(as.factor(TEMPE[,1]))
b <- data.frame(as.numeric(TEMPE[,2]))
a <- data.frame(TEMPE[,1])
b <- data.frame(as.numeric(TEMPE[,2]))
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
class(MUT$A_T)
class(MUT$Species)
class(MUT)
TEMPE = read.table('../../Body/1Raw/FishBaseTemperatures.txt', header = FALSE)
TEMPE$V1 = gsub(" ","_",TEMPE$V1)
names(TEMPE) = c("Species", "Temperature")
class(TEMPE$Temperature)
class(TEMPE$Species)
a <- data.frame(TEMPE[,1])
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
i <- sapply(MUT, is.factor)
MUT[i] <- lapply(MUT[i], as.character)
class(MUT$A_T)
class(MUT$Species)
class(MUT)
TEMPE = read.table('../../Body/1Raw/FishBaseTemperatures.txt', header = FALSE)
TEMPE$V1 = gsub(" ","_",TEMPE$V1)
names(TEMPE) = c("Species", "Temperature")
class(TEMPE$Temperature)
class(TEMPE$Species)
TemperMutALYA = merge(MUT,TEMPE)   # 1170 rows
View(TemperMutALYA)
TemperMut = merge(MUT,TEMPE)   # 1170 rows
###### Temperature, Mass, MetabolRate
###### Temperature ~ T_C
cor.test(TemperMut$T_C,TemperMut$Temperature, method = 'spearman') # super positive!!!! rho = 0.566
install.packages("ggpubr")
#install.packages("ggpubr")
library("ggpubr")
plotTCtemp = ggscatter(TemperMut, x = "Temperature", y = "T_C",
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "spearman",
xlab = "Temperature", ylab = "A>G")
View(plotTCtemp)
plotTCtemp
class(Temper$Species)
Temper = read.table('../../Body/1Raw/BodyParametersForAllClasses.txt',header = TRUE)
table(Temper$Class)
Temper = Temper[Temper$Class == 'Actinopterygii',]
class(Temper$Species)
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
i <- sapply(TEMPE, is.character)
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
TEMPE = read.table('../../Body/1Raw/FishBaseTemperatures.txt', header = FALSE)
TEMPE$V1 = gsub(" ","_",TEMPE$V1)
names(TEMPE) = c("Species", "Temperature")
class(TEMPE$Temperature)
class(TEMPE$Species)
i <- sapply(TEMPE, is.character)
class(TEMPE$Species)
TEMPE$Species
i <- sapply(TEMPE, is.factor)
i
i <- sapply(TEMPE$Species, is.factor)
i <- sapply(TEMPE$Species, is.character)
Tempe[i] <- lapply(TEMPE[i], as.factor)
Tempe[i] <- lapply(TEMPE$Species[i], as.factor)
TEMPE[i] <- lapply(TEMPE$Species[i], as.factor)
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
rm(list=ls(all=TRUE))
TEMPE = read.table('../../Body/1Raw/FishBaseTemperatures.txt', header = TRUE)
names(TEMPE) = c("Species", "Temperature")
class(TEMPE$Species)
TEMPE$V1 = gsub(" ","_",TEMPE$V1)
names(TEMPE) = c("Species", "Temperature")
class(TEMPE$Temperature)
class(TEMPE$Species)
View(TEMPE)
TEMPE$V1 = gsub(" ","_",TEMPE$V1)
class(TEMPE$Species)
TEMPE$V1 = gsub(" ","_",TEMPE$Species)
class(TEMPE$Species)
TEMPE$Species = gsub(" ","_",TEMPE$Species)
class(TEMPE$Species)
write.table(TEMPE, file="FishbaseTemperatures.txt", quote = FALSE, row.names = FALSE)
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
TEMPE = read.table('../../Body/1Raw/FishBaseTemperatures.txt', header = TRUE)
TEMPE = read.table('../../Body/1Raw/FishBaseTemperatures.txt', header = TRUE)
names(TEMPE) = c("Species", "Temperature")
TEMPE$Species = gsub(" ","_",TEMPE$Species)
class(TEMPE$Temperature)
class(TEMPE$Species)
write.table(TEMPE, file="FishBaseTemperature.txt", quote = FALSE, row.names = FALSE)
class(TEMPE$Temperature)
class(TEMPE$Species)
TEMPE = read.table('../../Body/1Raw/FishBaseTemperature.txt', header = TRUE)
TEMPE = read.table('../../Body/1Raw/FishBaseTemperature.txt', header = TRUE)
class(TEMPE$Temperature)
class(TEMPE$Species)
class(MUT$A_T)
class(MUT$Species)
TemperMut = merge(MUT,TEMPE)   # 1170 rows
View(TemperMut)
class(TEMPE$Species)
class(MUT$Species)
ggscatter(TemperMut, x = "Temperature", y = "T_C",
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "spearman",
xlab = "Temperature", ylab = "A>G")
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
View(MUT)
AnAge = read.table('../../Body/1Raw/anage_data.txt', sep = '\t', header = TRUE)
AnAge
View(AnAge)
AnAge$Species = paste(AnAge$Genus,AnAge$Species,sep = '_')
AnAge = AnAge[AnAge$Class == 'Actinopterygii',]
AnAgeMut = merge(MUT,AnAge) # 110
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
AnAge = read.table('../../Body/1Raw/anage_data.txt', sep = '\t', header = TRUE)
AnAge$Species = paste(AnAge$Genus,AnAge$Species,sep = '_')
AnAgeMut = merge(MUT,AnAge) # 110
View(AnAgeMut)
mono = AnAgeMut[AnAgeMut$Order == "Monotremata",]
View(mono)
rm(list=ls(all=TRUE))
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
Temper = read.table('../../Body/1Raw/BodyParametersForAllClasses.txt',header = TRUE)
table(Temper$Class)
Temper = Temper[Temper$Class == 'Actinopterygii',]
TemperMut = merge(MUT,Temper) # 320 species!!!
View(TemperMut)
### temperature in fishes
TemperMut = merge(MUT,TEMPE)   # 1170 rows
rm(list=ls(all=TRUE))
### read data
MUT = read.table('../../Body/3Results/VertebratePolymorphisms.MutSpecData.OnlyFourFoldDegAllGenes.txt', header = TRUE)
class(MUT$A_T)
class(MUT$Species)
TEMPE = read.table('../../Body/1Raw/FishBaseTemperature.txt', header = TRUE)
class(TEMPE$Temperature)
class(TEMPE$Species)
### calculating average for repeating species in TEMPE
averageTEMPE = aggregate(Temperature ~ ., mean, data = TEMPE)
View(averageTEMPE)
View(TEMPE)
View(averageTEMPE)
averageTemperMut = merge(MUT,averageTEMPE)
###### Temperature, Mass, MetabolRate
###### Temperature ~ T_C
cor.test(averageTemperMut$T_C,averageTemperMut$Temperature, method = 'spearman')
#install.packages("ggpubr")
library("ggpubr")
ggscatter(TemperMut, x = "Temperature", y = "T_C",
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "spearman",
xlab = "Temperature", ylab = "A>G")
ggscatter(averageTemperMut, x = "Temperature", y = "T_C",
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "spearman",
xlab = "Temperature", ylab = "A>G")
### temperature in fishes
TemperMut = merge(MUT,TEMPE)   # 1170 rows
